- if signed_in?
  .row
    .col-xs-12
      %p.text-right{style: "padding-top:5px;"}
        = link_to 'Logout', destroy_user_session_path, :method=>'delete'
        %a{href: new_activity_path}
          %span.glyphicon.glyphicon-plus-sign{style: "font-size:1.4em;"}
        %a{href: settings_path}
          %span.glyphicon.glyphicon-cog{style: "font-size:1.4em;"}
  - if @activities.present?
    .row
      %table.table
        - @activities.each do |a|
          %tr{:class => ("active" if a.active?(current_user)), id: a.id}
            %td
              = link_to (a.active?(current_user) ? stop_activity_path(a) : start_activity_path(a)), remote: true, :"data-start-path" => start_activity_path(a), :"data-stop-path" => stop_activity_path(a) do
                %h2
                  #{a.name}
                  %span.pull-right #{current_user.daily_activity_duration(a)}
        %tr.active
          %td
            %h2 Sleep
    :javascript
      $(function() {
        return $("a[data-remote]").on("ajax:success", function(e, data, status, xhr) {
          if(!data.stop){
            $(this).parents('tr').
                    siblings().
                    removeClass("active").
                    map(function(){
                      var a = $(this).find('a');
                      a.attr('href', a.data('start-path'));
                    });
          }
          $(this).parents('tr').toggleClass("active");
          $(this).attr('href', data.path + '?duration=' + $(this).find('span.duration').text());
        }).on("ajax:error", function(e, data, status, xhr){
          console.log(data);
          return alert("Something went wrong!");
        });
      });

  - else
    .row
      .col-xs-12.text-center
        %h2 You have no activities!
        %a{href: new_activity_path}
          %button.btn.btn-primary.btn-lg.btn-block{:type => "button"} Create one now
- else
  .row
    .col-xs-12.text-center
      %h2 Timeblocks
      %a{href: new_user_session_path}
        %button.btn.btn-primary.btn-lg.btn-block{:type => "button"} Sign In
      %a{href: new_user_registration_path}
        %button.btn.btn-default.btn-lg.btn-block{:type => "button"} Sign Up




